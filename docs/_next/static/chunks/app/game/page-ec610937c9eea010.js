(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{2305:function(e,t,s){Promise.resolve().then(s.bind(s,3476))},3476:function(e,t,s){"use strict";s.r(t),s.d(t,{PlayerController:function(){return L},default:function(){return b}});var l,a,n=s(9268),r=s(6006),o=s(6394),i=s.n(o),u=s(1932);class c{play(){0!==this.sounds.length&&(this.sounds[this.index].volume=this.volume,this.sounds[this.index].play(),this.index=(this.index+1)%this.channels)}loop(){0!==this.sounds.length&&(this.sounds[this.index].volume=this.volume,this.sounds[this.index].loop=!0,this.sounds[this.index].play())}stop(){if(0!==this.sounds.length)for(let e of this.sounds)e.pause(),e.currentTime=0}constructor(e){var t,s;this.sounds=[],this.index=0,this.channels=null!==(t=e.channels)&&void 0!==t?t:4,this.volume=null!==(s=e.volume)&&void 0!==s?s:1;for(let t=0;t<this.channels;t++)"undefined"!=typeof Audio&&this.sounds.push(new Audio(e.fileName))}}let d=new Map,f="/sfx/hit-1.wav";function h(e){let{startX:t,startY:s,IsLeft:l,setExplosion:a}=e,o=r.useRef(null),[c,h]=r.useState(0),[y,x]=r.useState(0),m=r.useContext(u.GlobalStateContext),p=!0===l?1:-1;0===c&&0===y&&(!0===l?(h(t+5),x(s+10)):(h(t),x(s+10)));let g=!0===l?m.player1Health:m.player0Health,v=!0===l?m.setPlayer1Health:m.setPlayer0Health;return r.useEffect(()=>{let e=setInterval(()=>{h(t=>{let s=function(e){let t=!0===l?m.player1X:m.player0X,s=!0===l?m.player1Y:m.player0Y;if(e>t&&e<t+6&&y>s&&y<s+20){var n;return null===(n=d.get(f))||void 0===n||n.play(),v(g-12),a(t=>[...t,{x:e,y:y}]),-100}return e+p}(t);if(s>=100||s<=1){var n;return clearInterval(e),null===(n=o.current)||void 0===n||n.remove(),!1}return s})},40);return()=>clearInterval(e)},[c]),(0,n.jsx)("div",{ref:o,className:"absolute",style:{width:"2%",height:"3%",left:"".concat(c,"%"),top:"".concat(y,"%"),willChange:"left, right"},children:(0,n.jsx)(i(),{src:"/img/CannonBall.png",alt:"",fill:!0})})}d.set(f,new c({fileName:f,volume:1}));var y=s(6008),x=function(){return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"relative w-screen h-screen overflow-hidden",children:[" ",(0,n.jsx)(i(),{className:"absolute w-screen h-screen",src:"/img/BgOnlt.png",alt:"",layout:"fill"}),(0,n.jsx)(i(),{className:"absolute w-screen h-screen wavesAnimation",src:"/img/waves2.png",alt:"Waves",layout:"fill"}),(0,n.jsx)(i(),{className:"absolute w-screen h-screen wavesAnimation",style:{top:"-100%"},src:"/img/waves2.png",alt:"Waves",layout:"fill"}),(0,n.jsx)(i(),{className:"absolute w-screen h-screen",src:"/img/IslandInMiddle.png",alt:"",layout:"fill"}),(0,n.jsx)(i(),{className:"absolute w-screen h-screen WaterMovingMiddle",src:"/img/Skum.png",alt:"",layout:"fill"}),(0,n.jsx)(i(),{className:"absolute w-screen h-screen",src:"/img/BgCoreOverlay.png",alt:"",layout:"fill"})]})})};function m(e){let t=r.useRef(null);return(0,n.jsx)("div",{ref:t,className:"absolute",style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"%"),width:"5%",height:"7%",zIndex:10},children:(0,n.jsx)(i(),{className:"absolute w-screen h-screen explosionAnimation",src:"/img/HitExplosion.png",alt:"Explosion",layout:"fill"})})}function p(e){let t=r.useRef(null),s=!0===e.Isleft?e.x+5:e.x,l=(e.Isleft,e.y+10),a=!0===e.Isleft?"90deg":"-90deg";return(0,n.jsx)("div",{ref:t,className:"absolute",style:{left:"".concat(s,"%"),top:"".concat(l,"%"),width:"5%",height:"10%",zIndex:10,rotate:"".concat(a)},children:(0,n.jsx)(i(),{className:"absolute w-screen h-screen explosionAnimation",src:"/img/ShootEffect.png",alt:"Explosion",layout:"fill"})})}let g=(e,t,s,l)=>{let a={ArrowDown:{x:0,y:.1},ArrowUp:{x:0,y:-.1},ArrowLeft:{x:-.1,y:0},ArrowRight:{x:.1,y:0},KeyS:{x:0,y:.1},KeyW:{x:0,y:-.1},KeyA:{x:-.1,y:0},KeyD:{x:.1,y:0}};(t?["KeyS","KeyW","KeyA","KeyD"]:["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"]).forEach(t=>{e[t]&&l(e=>({x:e.x+a[t].x,y:e.y+a[t].y}))})},v=new Map,w="/sfx/theme-loop-1.wav";v.set(w,new c({fileName:w,volume:.15})),null===(l=v.get(w))||void 0===l||l.loop();let I="/sfx/creak-0.wav";v.set(I,new c({fileName:I,volume:.25})),null===(a=v.get(I))||void 0===a||a.loop();let j="/sfx/shot-1.wav";function N(e){let t=r.useRef(null),[s,l]=r.useState([]),[a,o]=r.useState({x:0,y:0}),[c,d]=r.useState(!1),[f,x]=r.useState(5),[w,I]=r.useState(null),N=(0,y.useRouter)(),[L,b]=r.useState(e.IsLeft?"/img/BoatBlue.png":"/img/BoatRed.png"),S=r.useContext(u.GlobalStateContext),k=e.IsLeft?S.player0Health:S.player1Health,B=e.IsLeft?S.setPlayer0Health:S.setPlayer1Health,E=e.IsLeft?S.player0X:S.player1X,A=e.IsLeft?S.player0Y:S.player1Y,C=e.IsLeft?S.setPlayer0X:S.setPlayer1X,_=e.IsLeft?S.setPlayer0Y:S.setPlayer1Y,[D,P]=r.useState([]),[R,H]=r.useState([]),X={height:"100%",width:"".concat(k,"%"),backgroundColor:(k<=0&&N.push("/game/over?loser=".concat(e.id)),k>60)?"green":k>25?"yellow":"red",transition:"width 0.3s ease"},Y=()=>{if(f>0){var t;null===(t=v.get(j))||void 0===t||t.play(),H(e=>[...e,{x:E,y:A}]),l(e=>[...e,{startX:E,startY:A}]),x(e=>e-1),e.IsLeft?(C(e=>e-.2),o(e=>({x:e.x-.05,y:e.y}))):(C(e=>e+.2),o(e=>({x:e.x+.05,y:e.y}))),c||(d(!0),setTimeout(()=>{x(5),d(!1)},3e3))}};return r.useEffect(()=>{g(e.keypressed,e.IsLeft,a,o),e.keypressed.Space&&e.IsLeft&&Y(),e.keypressed.Enter&&!e.IsLeft&&Y(),e.keypressed.Escape&&N.push("/game/pause")},[e.keypressed]),0===E&&0===A&&(!0===e.IsLeft?(C(20),_(20)):(C(80),_(20))),r.useEffect(()=>{k>60||(k>25?("/img/BoatBlueDamaged.png"!==L||"/img/BoatRedDamaged.png"!==L)&&b(e.IsLeft?"/img/BoatBlueDamaged.png":"/img/BoatRedDamaged.png"):("/img/BoatBlueVeryDamaged.png"!==L||"/img/BoatRedVeryDamaged.png"!==L)&&b(e.IsLeft?"/img/BoatBlueVeryDamaged.png":"/img/BoatRedVeryDamaged.png"));let t=setInterval(()=>{C(t=>{var s;return(s=t)<-3&&!0===e.IsLeft&&(B(k-9),a.x=-1*a.x,s=-3),s>94&&!1===e.IsLeft&&(B(k-9),a.x=-1*a.x,s=94),s>40&&!0===e.IsLeft&&(B(k-9),a.x=-1*a.x,s=40),s<52&&!1===e.IsLeft&&(B(k-9),a.x=-1*a.x,s=52),s+a.x}),_(t=>(t<-1&&(B(k-9),a.y=-1*a.y),t>83&&N.push("/game/over?loser=".concat(e.id)),a.y=a.y+.005,t+a.y))},30);return()=>clearInterval(t)},[a]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"absolute",style:{left:"".concat(E,"%"),top:"".concat(A,"%"),color:"white"},children:f}),(0,n.jsxs)("span",{id:"player",ref:t,className:"absolute outline-none",style:{width:"8%",height:"25%",left:"".concat(E,"%"),top:"".concat(A,"%"),willChange:"transform, top, left"},tabIndex:0,children:[(0,n.jsx)(i(),{className:"absolute",src:"/img/BoatWaterMove3.png",alt:"",layout:"fill"}),(0,n.jsx)(i(),{className:"absolute",src:L,alt:"",layout:"fill"}),(0,n.jsx)("div",{className:"health-bar-container",children:(0,n.jsx)("div",{style:X})})]}),null==s?void 0:s.map((t,s)=>(0,n.jsx)(h,{startX:t.startX,startY:t.startY,IsLeft:e.IsLeft,setExplosion:P},s)),null==D?void 0:D.map((e,t)=>(0,n.jsx)(m,{x:e.x,y:e.y},t)),null==R?void 0:R.map((t,s)=>(0,n.jsx)(p,{x:t.x,y:t.y,Isleft:e.IsLeft},s))]})}function L(){let[e,t]=r.useState({}),s=r.useCallback(e=>{t(t=>({...t,[e.code]:!0}))},[]),l=r.useCallback(e=>{t(t=>({...t,[e.code]:!1}))},[]);return r.useEffect(()=>(window.addEventListener("keydown",s),window.addEventListener("keyup",l),()=>{window.removeEventListener("keydown",s),window.removeEventListener("keyup",l)}),[s,l]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N,{id:"player-0",IsLeft:!0,keypressed:e}),(0,n.jsx)(N,{id:"player-1",IsLeft:!1,keypressed:e})]})}function b(){return(0,n.jsxs)("main",{className:"w-full h-full",children:[(0,n.jsx)(x,{}),(0,n.jsx)(L,{})]})}v.set(j,new c({fileName:j,volume:1}))},1932:function(e,t,s){"use strict";s.r(t),s.d(t,{GlobalStateContext:function(){return i},Providers:function(){return o},default:function(){return u}});var l=s(9268),a=s(7977),n=s.n(a);s(7402);var r=s(6006);function o(e){let{children:t}=e;return(0,l.jsx)(l.Fragment,{children:t})}let i=r.createContext([]);function u(e){let{children:t}=e,[s,a]=r.useState(20),[o,u]=r.useState(20),[c,d]=r.useState(80),[f,h]=r.useState(20),[y,x]=r.useState(100),[m,p]=r.useState(100);return(0,l.jsx)("html",{className:"w-screen h-screen overflow-hidden",lang:"en",children:(0,l.jsx)("body",{className:"".concat(n().className," w-full h-full"),children:(0,l.jsx)(i.Provider,{value:{player0X:s,setPlayer0X:a,player0Y:o,setPlayer0Y:u,player1X:c,setPlayer1X:d,player1Y:f,setPlayer1Y:h,player0Health:y,setPlayer0Health:x,player1Health:m,setPlayer1Health:p},children:t})})})}},7402:function(){},7977:function(e){e.exports={style:{fontFamily:"'__Inter_8690d5', '__Inter_Fallback_8690d5'",fontStyle:"normal"},className:"__className_8690d5"}}},function(e){e.O(0,[891,253,769,744],function(){return e(e.s=2305)}),_N_E=e.O()}]);